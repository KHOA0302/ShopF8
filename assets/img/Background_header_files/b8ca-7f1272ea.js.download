(window.webpackJsonp=window.webpackJsonp||[]).push([["b8ca"],{"7esR":function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));class n{constructor(e,t=(()=>{}),s=(()=>{})){if(this.interval=void 0,this.lastRun=0,this.lastUpdated=0,this.queued=void 0,this.onResolve=void 0,this.onReject=void 0,!Number.isFinite(e))throw new TypeError("Expected `interval` to be a finite number");this.interval=e,this.onResolve=t,this.onReject=s}add(e){const t=Date.now();if(!this.lastRun||t>this.lastRun+this.interval)return this.queued&&this.clear(),void this.run(t,e);clearTimeout(this.queued),this.queued=setTimeout(()=>{this.queued=null,this.run(t,e)},this.interval)}run(e,t){this.lastRun=e;const s=t();return"function"!=typeof s.then?Promise.reject(new Error("Expected supplied function to be a promise creator")):s.then(t=>{e>this.lastUpdated&&(this.lastUpdated=e,this.onResolve(t))},e=>this.onReject(e))}clear(){clearTimeout(this.queued),this.queued=null}}},Q2fV:function(e,t,s){"use strict";function n(e){return{"aria-activedescendant":e["aria-activedescendant"],"aria-autocomplete":e["aria-autocomplete"],"aria-describedby":e["aria-describedby"],"aria-expanded":e["aria-expanded"],"aria-owns":e["aria-owns"],autoComplete:"off",autoCorrect:"off",spellCheck:!1,id:e.id,onChange:e.onChange,onFocus:e.onFocus,onKeyUp:e.onKeyUp,onKeyDown:e.onKeyDown,role:e.role,ref:e.refForFocus,value:e.value}}s.d(t,"a",(function(){return n}))},UfFQ:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("XfPh"),i=s("cc4C");function o(e){return e?e.suggestionType===i.c.NON_INTERACTIVE_MESSAGE?"":Object(n.a)(e,"name")?e.name:Object(n.a)(e,"location")?e.location:Object(n.a)(e,"searchParams")&&Object(n.a)(e.searchParams,"location")?e.searchParams.location:"":""}},cV4d:function(e,t,s){"use strict";var n=s("q1tI"),i=s.n(n),o=s("17x9"),a=s.n(o),u=s("cVPA"),r=s.n(u),h=s("PuV7"),l=s("Ri7V"),c=s("XfPh"),p=s("AKUS");function d({onOutsideFocus:e,children:t}){const{ref:s,onBlur:n}=Object(p.a)(e);return i.a.createElement("div",{ref:s,onBlur:n},t)}var g=s("2jR3"),S=s("cc4C");a.a.string.isRequired,a.a.number,a.a.any,a.a.bool,a.a.func,a.a.func,a.a.func,a.a.func,a.a.func,a.a.bool,a.a.string,a.a.arrayOf(a.a.string);const f={defaultActiveIndex:-1,defaultSelectedSuggestion:null,defaultIsOpen:void 0,onChange(){},onSelect(){},onStateChange(){},onOutsideClick:void 0,suggestionToString:e=>e,checkMountBugExperiment:!1};function I(){return{"aria-atomic":!0,"aria-live":"polite",role:"status"}}function v(e){e.key===S.b.ENTER&&e.preventDefault()}class m extends n.Component{constructor(e){super(e),this.id="Koan-"+e.id,this.state={activeIndex:e.defaultActiveIndex,selectedSuggestion:e.defaultSelectedSuggestion,isOpen:!!e.defaultIsOpen,isFocused:!1,userInput:null},this.activeSuggestion=null,this.getAriaDescriptionId=this.getAriaDescriptionId.bind(this),this.getInputProps=this.getInputProps.bind(this),this.getInputValue=this.getInputValue.bind(this),this.getSuggestionProps=this.getSuggestionProps.bind(this),this.getDropdownProps=this.getDropdownProps.bind(this),this.openDropdown=this.openDropdown.bind(this),this.closeDropdown=this.closeDropdown.bind(this),this.selectSuggestion=this.selectSuggestion.bind(this),this.selectActiveSuggestion=this.selectActiveSuggestion.bind(this),this.clearInput=this.clearInput.bind(this),this.handleInputChange=this.handleInputChange.bind(this),this.handleInputFocus=this.handleInputFocus.bind(this),this.handleInputKeyUp=this.handleInputKeyUp.bind(this),this.handleMouseLeave=this.handleMouseLeave.bind(this),this.handleSuggestionKeyUp=this.handleSuggestionKeyUp.bind(this),this.handleOutsideFocus=this.handleOutsideFocus.bind(this),this.setInputRef=this.setInputRef.bind(this)}UNSAFE_componentWillReceiveProps(e){let{defaultActiveIndex:t,defaultSelectedSuggestion:s}=e,n=babelHelpers.objectWithoutPropertiesLoose(e,["defaultActiveIndex","defaultSelectedSuggestion"]);if(s&&s!==this.props.defaultSelectedSuggestion&&s!==this.state.selectedSuggestion){const{defaultIsOpen:e}=n;this.setState({isOpen:!!e,activeIndex:t,selectedSuggestion:s,userInput:null})}!s&&this.props.defaultSelectedSuggestion&&this.props.defaultSelectedSuggestion===this.state.selectedSuggestion&&this.setState({selectedSuggestion:null}),t!==this.props.defaultActiveIndex&&this.state.activeIndex===this.props.defaultActiveIndex&&this.setState({activeIndex:t})}componentDidMount(){if(!this.inputRef)return;const e=this.inputRef.value||null,t=document.activeElement===this.inputRef;if(t||e){const{checkMountBugExperiment:e}=this.props;if(e&&l.a.getBootstrap("big_search_location_mount_fix_experiment")&&h.a.deliverExperiment("big_search_location_mount_fix",{treatment_unknown:()=>!1,control:()=>!0,treatment:()=>!1}))return}t?this.internalSetState({userInput:e,isOpen:!0,type:S.a.INPUT_FOCUS,isFocused:!0}):e&&this.setState({userInput:e})}componentWillUnmount(){this.timeout&&clearTimeout(this.timeout)}getSuggestionElementId(e){return`${this.id}__option-${e}`}getInputValue({focusedInputValue:e}={},t=this.state){const{userInput:s,selectedSuggestion:n,isFocused:i}=t,{suggestionToString:o}=this.props;if(this.activeSuggestion)return this.activeSuggestion;if(null!=s)return s;if(i&&null!=e)return e;if(null!=n){const e=o(n);return null!=e?e:""}return""}getInputProps({focusedInputValue:e,id:t}={}){const{activeIndex:s,isFocused:n,isOpen:i}=this.state;this.inputId=this.inputId||t||this.id+"__input";const o=this.getInputValue({focusedInputValue:e});return{"aria-activedescendant":i&&s>=0?this.getSuggestionElementId(s):void 0,"aria-autocomplete":"list","aria-expanded":i,"aria-owns":i?this.getDropdownId():void 0,id:this.inputId,isFocused:n,onChange:this.handleInputChange,onFocus:this.handleInputFocus,onKeyUp:this.handleInputKeyUp,onKeyDown:v,refForFocus:this.setInputRef,role:"combobox",value:o}}getDropdownId(){return this.id+"__listbox"}getDropdownProps(){return{"aria-label":r.a.t("search.voiceover.VoiceOver_description_for_list_of_search_suggestions"),id:this.getDropdownId(),onMouseLeave:this.handleMouseLeave}}getAriaDescriptionId(){return this.id+"__description"}getSuggestionProps({suggestion:e}){e||Object(g.a)(new Error("suggestion is a required prop of getSuggestionProps"));const{activeIndex:t}=this.state;this.suggestions.push(e);const s=this.suggestions.length-1,n=()=>{s!==this.state.activeIndex&&this.setActiveIndex(s,{type:S.a.SUGGESTION_MOUSE_ENTER})};return{"aria-selected":t===s,id:this.getSuggestionElementId(s),isActive:t===s,onClick:t=>{t.preventDefault(),this.selectSuggestion(e,{type:S.a.CLICK})},onFocus:n,onKeyUp:this.handleSuggestionKeyUp,onMouseEnter:n,role:"option",tabIndex:-1}}getStateAndHelpers(){const{activeIndex:e,isFocused:t,isOpen:s,selectedSuggestion:n,userInput:i}=this.state,{getAriaDescriptionId:o,getDropdownProps:a,getInputProps:u,getInputValue:r,getSuggestionProps:h,openDropdown:l,closeDropdown:c,selectSuggestion:p,selectActiveSuggestion:d,clearInput:g}=this,{suggestionToString:S}=this.props;return{getAriaDescriptionId:o,getDropdownProps:a,getInputProps:u,getInputValue:r,getStatusProps:I,getSuggestionProps:h,openDropdown:l,closeDropdown:c,selectSuggestion:p,selectActiveSuggestion:d,clearInput:g,id:this.id,activeIndex:e,isFocused:t,isOpen:s,userInput:i,selectedSuggestion:n,suggestionToString:S}}setActiveIndex(e,t){this.internalSetState(Object.assign({activeIndex:e},t))}setInputRef(e){this.inputRef=e}getSuggestionCount(){return this.suggestions.length}handleInputChange(e){const t="string"==typeof e?e:e&&e.target&&e.target.value;null!=this.activeSuggestion&&(this.activeSuggestion=null),this.internalSetState({type:S.a.INPUT_CHANGE,isOpen:!0,userInput:t})}handleInputFocus(){this.timeout=setTimeout(()=>{if(this.timeout=null,this.inputRef&&"function"==typeof this.inputRef.setSelectionRange){const e=this.inputRef.value&&this.inputRef.value.length||0;this.inputRef.setSelectionRange(e,e)}this.internalSetState({isOpen:!0,type:S.a.INPUT_FOCUS,isFocused:!0})})}handleInputKeyUp(e){const t=e.key;t===S.b.ARROW_DOWN?this.handleKeyArrowDown(e):t===S.b.ARROW_UP?this.handleKeyArrowUp(e):t===S.b.ENTER?this.handleKeyEnter(e):t===S.b.ESCAPE&&this.handleKeyEscape(e)}handleMouseLeave(){const{defaultActiveIndex:e}=this.props;this.internalSetState({activeIndex:e,type:S.a.MOUSE_LEAVE})}handleSuggestionKeyUp(e){e.key===S.b.ENTER&&this.handleKeyEnter(e)}handleKeyArrowDown(e){e.preventDefault();const{isOpen:t}=this.state;t?this.moveActiveIndexByKey(1,{type:S.a.KEY_ARROW_DOWN}):this.internalSetState({type:S.a.KEY_ARROW_DOWN,isOpen:!0})}handleKeyArrowUp(e){e.preventDefault();const{isOpen:t}=this.state;t&&this.moveActiveIndexByKey(-1,{type:S.a.KEY_ARROW_UP})}handleKeyEnter(e){e.preventDefault();const{activeIndex:t,userInput:s}=this.state;(-1===t||0===this.getSuggestionCount())&&s&&s.length>0?this.handleSubmit():this.selectActiveSuggestion({type:S.a.KEY_ENTER})}handleKeyEscape(e){const{defaultActiveIndex:t}=this.props;e.preventDefault(),this.activeSuggestion=null,this.internalSetState({type:S.a.KEY_ESC,isOpen:!1,activeIndex:t})}moveActiveIndexByKey(e,t){const s=this.getSuggestionCount()-1;if(s<0)return;const{suggestionToString:n}=this.props,{activeIndex:i}=this.state;let o=i+e;o<-1?o=s:o>s&&(o=-1),this.activeSuggestion=-1===o?null:n(this.suggestions[o]),this.internalSetState(Object.assign({activeIndex:o},t))}selectActiveSuggestion(e){const{defaultActiveIndex:t}=this.props,{activeIndex:s}=this.state,n=-1===s?t:s,i=this.suggestions[n];null!=i&&this.selectSuggestion(i,e)}handleSubmit(){const{defaultActiveIndex:e}=this.props;this.internalSetState({type:S.a.INPUT_SUBMIT,isOpen:!1,activeIndex:e})}selectSuggestion(e,t){const{defaultActiveIndex:s,suggestionToString:n}=this.props;this.internalSetState(Object.assign({isOpen:!1,activeIndex:s,selectedSuggestion:e,inputValue:n(e),userInput:n(e)},t))}clearInput(e){this.isClearing=!0,this.internalSetState({userInput:"",inputValue:"",selectedSuggestion:this.props.defaultSelectedSuggestion,type:S.a.INPUT_CLEAR},()=>{this.timeout=setTimeout(()=>{this.timeout=null,this.isClearing=!1,this.activeSuggestion=null,this.inputRef&&"function"==typeof this.inputRef.focus&&this.inputRef.focus(),"function"==typeof e&&e()})})}internalSetState(e,t){const s="function"==typeof e,n={};let i,o,a,u=!1;return this.setState(t=>{const r={},h=s?e(t):e;return i=Object(c.a)(h,"selectedSuggestion")&&h.selectedSuggestion!==this.props.defaultSelectedSuggestion,i&&(o=h.selectedSuggestion,a={interactionType:h.type,activeIndex:t.activeIndex,userInput:t.userInput},u=i&&o!==t.selectedSuggestion),Object.entries(h).forEach(([e,s])=>{t[e]!==s&&(n[e]=s),"userInput"===e&&(n.inputValue=this.getInputValue(void 0,h)),"type"!==e&&("isOpen"===e&&null!=this.props.defaultIsOpen||(r[e]=s))}),r},()=>{"function"==typeof t&&t(),this.props.onStateChange(n,this.getStateAndHelpers()),i&&this.props.onSelect(o,a,this.getStateAndHelpers()),u&&this.props.onChange(o,a,this.getStateAndHelpers())})}handleOutsideFocus(){const{onOutsideClick:e}=this.props,{userInput:t}=this.state;this.isClearing||("function"!=typeof e?this.closeDropdown(Object.assign({type:S.a.INPUT_BLUR},""===t?{userInput:null}:null)):e(this.getStateAndHelpers()))}openDropdown(){this.internalSetState({isOpen:!0})}closeDropdown(e){const{defaultActiveIndex:t}=this.props;this.activeSuggestion=null,this.internalSetState(Object.assign({isOpen:!1,isFocused:!1,activeIndex:t},e))}clearSuggestions(){this.suggestions=[]}reset(e,t){this.internalSetState(Object.assign({isOpen:!1,activeIndex:this.props.defaultActiveIndex,userInput:null},e),t)}render(){return this.clearSuggestions(),i.a.createElement(d,{onOutsideFocus:this.handleOutsideFocus},this.props.render(this.getStateAndHelpers()))}}m.defaultProps=f;t.a=m},oHGl:function(e,t,s){"use strict";var n=s("q1tI"),i=s.n(n),o=s("2mql"),a=s.n(o),u=s("hBwV"),r=s.n(u),h=s("QD4+"),l=s("nBiR"),c=s("cc4C"),p=s("Vh4E"),d=s("Zr9h"),g=s("tfQw"),S=s("IeNy"),f=s("RnRr"),I=s("8NF4"),v=s("7esR"),m=s("HnpV"),b=s("K/Jt");const y=Object.assign({},l.f,{onClear(){},onFocus(){},onBlur(){},onSelect(){},onSubmit(){},wait:200});let R;!function(e){e[e.Reentry=1]="Reentry",e[e.Suggestions=2]="Suggestions"}(R||(R={}));function x(e){return null==e?void 0:e.includes("/homes/lts")}t.a=function(e){class t extends n.Component{constructor(e){super(e),this.mode=R.Reentry,this.logger=new I.a,this.allSuggestions=[],this.searchAutosuggester=new g.a,this.hasLoggedAutosuggestExperiment=!1,this.requestManager=void 0,this.reentryMode=[],this.state={sections:[]},this.isComponentMounted=!1,this.handleStateChange=this.handleStateChange.bind(this),this.handleSelection=this.handleSelection.bind(this),this.buildReentryMode=this.buildReentryMode.bind(this),this.showReentryMode=this.showReentryMode.bind(this),this.handleRequestManagerResponse=this.handleRequestManagerResponse.bind(this),this.requestManager=new v.a(e.wait,this.handleRequestManagerResponse)}componentDidMount(){this.isComponentMounted=!0,S.a.sync().then(({versionChanged:e})=>{e&&this.forceUpdate()}),this.searchAutosuggester.init({refinementPaths:this.props.refinementPaths||this.props.refinementPath&&[this.props.refinementPath]||void 0,skipCache:!0,autosuggestOptions:["simple_search"]}).then(()=>this.buildReentryMode()),this.buildReentryMode()}UNSAFE_componentWillReceiveProps(e){const{refinementPaths:t}=e;(!Object(b.a)(t,this.props.refinementPaths)||this.props.refinementPath&&!Object(b.a)(t,[this.props.refinementPath]))&&this.searchAutosuggester.init({refinementPaths:t,skipCache:!0,autosuggestOptions:["simple_search"]}).then(()=>{this.buildReentryMode()})}componentWillUnmount(){this.isComponentMounted=!1,this.requestManager.clear()}handleStateChange(e,t){switch(e.type){case c.a.INPUT_FOCUS:return this.handleFocus(t);case c.a.INPUT_BLUR:return this.handleBlur(e,t);case c.a.INPUT_CHANGE:return this.handleInputChange(e);case c.a.INPUT_CLEAR:return this.handleInputClear();case c.a.INPUT_SUBMIT:return this.handleSubmit(e,t);default:return}}requestAutocomplete(e){const{refinementPaths:t,autocompleteVertical:s}=this.props;this.requestManager.add(()=>Object(d.b)(e,{userMarket:S.a.getData(),maxResults:6,currentTab:Object(m.g)(t),shouldFilterByVerticalRefinement:!0,hideNavResults:!0,isSimpleSearch:!0,autocompleteVertical:s,excludeListingNames:x(t)}).then(({results:t,metadata:s})=>({results:t,metadata:s,userInput:e})))}handleInputChange({userInput:e}){const{onInputChange:t}=this.props;if(null==e||""===e)return this.logger.initialize(),this.requestManager.clear(),void this.showReentryMode();this.mode===R.Reentry&&this.setState({sections:[]}),t&&t(e),this.requestAutocomplete(e)}handleRequestManagerResponse(e){if(null==e)return;const{searchContext:t}=this.props,{results:s,metadata:n,userInput:i}=e,o=S.a.getLoggingData(),a=s;this.logger.logAutocompleteImpression(Object.assign({input:i,results:a,responseMetadata:n||{},exploreSearchContext:t},o)),this.mode=R.Suggestions,this.allSuggestions=s;const u=s&&s.length?[Object(f.d)(s)]:[];this.setState({sections:u})}findIndexInSection(e){for(let t=0;t<this.state.sections.length;t+=1){const s=this.state.sections[t].results.findIndex(t=>e.key===t.key);if(-1!==s)return s}return-1}handleSelection(e,t,s){const{searchContext:n,onSelect:i}=this.props,{interactionType:o,activeIndex:a,userInput:u}=t,r=this.mode===R.Reentry?this.findIndexInSection(e):a;if(e.searchType!==h.n){const t=e;this.logger.logAutocompleteSelected(Object.assign({isKeyboardSubmission:o!==c.a.CLICK,results:this.allSuggestions,selectedItem:t,activeIndex:r,input:u||"",exploreSearchContext:n},S.a.getLoggingData()))}i(e,t,s)}handleSubmit(e,{userInput:t}){const{defaultSelectedSuggestion:s,searchContext:n,onSubmit:i}=this.props;let o=t;(o||(s&&(o=s.inputValue),o))&&(this.logger.logAutocompleteSelected(Object.assign({isKeyboardSubmission:!0,results:[],activeIndex:-1,input:o,exploreSearchContext:n},S.a.getLoggingData())),i(o))}handleInputClear(){const{onClear:e}=this.props;this.showReentryMode(),e()}handleFocus({userInput:e}){e?this.requestAutocomplete(e):(this.showReentryMode(!0),this.logger.startSession());const{sections:t}=this.state,{onInputFocus:s,onFocus:n}=this.props;s&&s({sections:t}),n()}handleBlur(e,{userInput:t}){const{onBlur:s}=this.props;this.logger.endSession(),s(t)}buildReentryMode(){this.updateReentryMode(),this.showReentryMode()}updateReentryMode(){this.reentryMode=[this.searchAutosuggester.nearbySection(),...this.searchAutosuggester.sections()].filter(Boolean)}showReentryMode(e=!1){if(this.isComponentMounted){if(this.mode=R.Reentry,e){const e=this.searchAutosuggester.sections();if(e&&e.length){const t=[];e.forEach(e=>t.push(...e.results||[])),this.logger.logAutocompleteImpression({input:"",responseMetadata:{},results:t,sectionTypesList:e.map(e=>{var t;return null!==(t=e.type)&&void 0!==t?t:""}),sectionTitlesList:e.map(e=>{var t;return null!==(t=e.title)&&void 0!==t?t:""}),maxNumRowsList:e.map(e=>{var t;return null!==(t=e.maxNumRows)&&void 0!==t?t:-1})})}this.hasLoggedAutosuggestExperiment||(Object(p.b)(this.searchAutosuggester.getExperimentName(),this.searchAutosuggester.getTreatmentName()),this.hasLoggedAutosuggestExperiment=!0)}this.setState({sections:this.reentryMode})}}render(){const t=this.props,{currentTab:s}=t,n=babelHelpers.objectWithoutPropertiesLoose(t,["currentTab","searchContext","exploreTabsAutosuggestionsResponse","onClear","onFocus","onBlur","onSubmit","onSelect","wait"]),{sections:o}=this.state,a=e;return i.a.createElement(a,Object.assign({onStateChange:this.handleStateChange,onSelect:this.handleSelection,sections:o,currentTab:s},n))}}return t.WrappedComponent=e,t.defaultProps=y,t.displayName=r()(e,"withSimpleSearchController"),a()(t,e)}},rLrX:function(e,t,s){"use strict";function n(e=[]){return e.reduce((e,t)=>t&&t.results&&t.results.length?e+t.results.length:e,0)}s.d(t,"a",(function(){return n}))}}]);
//# sourceMappingURL=https://sourcemaps.d.musta.ch/airbnb/static/packages/b8ca-b4bf43f0.js.map